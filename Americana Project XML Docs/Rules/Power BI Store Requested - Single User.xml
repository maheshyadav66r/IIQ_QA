<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sailpoint PUBLIC "sailpoint.dtd" "sailpoint.dtd">
<sailpoint>
<Rule language="beanshell" name="Power BI Store Requested - Single User" type="AllowedValues">
  <Description>This rule is configured on the application and is called after the connector has build a ResourceObject from the native application data.

Initially designed for non-rule based connectors to add SPPrivileged flag to an object, but could be used to do any transformations.</Description>
  <Signature returnType="ResourceObject">
    <Inputs>
      <Argument name="log">
        <Description>
          The log object associated with the SailPointContext.
        </Description>
      </Argument>
      <Argument name="context">
        <Description>
          A sailpoint.api.SailPointContext object that can be used to query the database if necessary.
        </Description>
      </Argument>
      <Argument name="object">
        <Description>
          The ResourceObject built by the connector.
        </Description>
      </Argument>
      <Argument name="application">
        <Description>
          Application that references the connector.
        </Description>
      </Argument>
      <Argument name="connector">
        <Description>
          The connector object.
        </Description>
      </Argument>
      <Argument name="state">
        <Description>
          A Map containing state information.
        </Description>
      </Argument>
    </Inputs>
    <Returns>
      <Argument name="resourceObject">
        <Description>
          The updated resource object.
        </Description>
      </Argument>
    </Returns>
  </Signature>
  <Source>
import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

List storeAR = new ArrayList();
String csvFile ="E:\\WorkItemReport\\PowerBIWorkItemDeails-new.csv";
int startRow = 35785;
int endRow = 40901;
int columnIndex = 2;
String requesterId = "44073";

try{
	BufferedReader bufferedReader = new BufferedReader(new FileReader(csvFile));
	String line;
	int currentRow = 0;
	while((line = bufferedReader.readLine()) != null &amp;&amp; currentRow &lt;= endRow){
		if(currentRow &gt;= startRow){
			String[] data = line.split(",");
			if(data.length &gt; columnIndex){
				if (requesterId.equalsIgnoreCase(String.valueOf(data[columnIndex]))){
					storeAR.add(data[columnIndex + 2]);
				}
			}
		}
		currentRow++;
	}
}
catch (Exception e){
	throw new RuntimeException(e);
}
return storeAR;
</Source>
</Rule>

</sailpoint>