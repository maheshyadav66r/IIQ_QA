<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sailpoint PUBLIC "sailpoint.dtd" "sailpoint.dtd">
<sailpoint>
<Rule language="beanshell" name="Americana-Rule-FieldValue-AD-manager" type="FieldValue">
  <Description>This rule can be used to generate a field value (eg - an account name) using data from the given Identity. If this rule is run in the context of a workflow step then the arguments passed into the step will also be available. Also, any field values that have been processed so far from the policy related to the Application/Role will be available.</Description>
  <ReferencedRules>
    <Reference class="sailpoint.object.Rule" name="Americana-RuleLibrary-Attribute" />
  </ReferencedRules>
  <Signature returnType="String" />
  <Source>
  import sailpoint.api.*;
  import sailpoint.object.Application;
  import sailpoint.object.Identity;
  import sailpoint.object.Link;
    
  Identity manager = identity.getManager();
  if(manager != null){
  Application app = context.getObjectByName(Application.class, "Active Directory");
  Link account = manager.getLink(app);
  if(account != null){
  String distinguishedName = account.getAttribute("distinguishedName");
  
  if(null != distinguishedName &amp;&amp; !distinguishedName.isEmpty())
    return distinguishedName;
    }
  }
  return null;
  </Source>
</Rule>

</sailpoint>