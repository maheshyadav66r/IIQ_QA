<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE sailpoint PUBLIC "sailpoint.dtd" "sailpoint.dtd">
<sailpoint>
<Form name="Americana_ContractorEndDateExtension_Second_Level_Approval_Form" type="Workflow">
  <Attributes>
    <Map>
      <entry key="pageTitle" value="Contractor End Date Extension - Second Level Approval form" />
    </Map>
  </Attributes>
  <Section label="Selected Contractor Details to extend the end date">
    <Field columnSpan="2" displayName="Selected Contractor" name="user" readOnly="true" required="true" type="String" />
  </Section>
  <Section columns="2" label="User Details" type="text">
    <Field columnSpan="1" displayName="First name" name="firstname" readOnly="true" type="String" />
    <Field columnSpan="1" displayName="Last name" name="lastname" readOnly="true" type="String" />
    <Field columnSpan="1" displayName="Job Title" name="jobTitle" readOnly="true" type="String" />
    <Field columnSpan="1" displayName="Department" name="department" readOnly="true" type="String" />
    <Field columnSpan="1" displayName="Manager" displayType="combobox" name="manager" readOnly="true" type="String" />
    <Field columnSpan="1" displayName="EndDate" name="endDate" readOnly="true" type="String" />
  </Section>
  <Section label="End Date Extension Details">
    <Field columnSpan="1" displayName="Enter New End date" name="newEndDate" readOnly="true" required="true" type="String" />
  </Section>
  <Section>
    <Field columnSpan="1" displayName="Business Justification" displayType="combobox" name="justification" postBack="true" readOnly="true" required="true" type="string">
      <AllowedValues>
        <String>Extend the Contract</String>
        <String>Other</String>
      </AllowedValues>
    </Field>
    <Field columnSpan="1" displayName="Justificatiion Reason" displayType="textarea" dynamic="true" name="otherJustificationReason" readOnly="true" required="true" type="string">
      <Attributes>
        <Map>
          <entry key="hidden">
            <value>
              <Script>
                <Source>
                  boolean hideField = true;
                  if(null != form.getField("justification").getValue() @and "Other".equalsIgnoreCase(form.getField("justification").getValue())){
                  	hideField = false;
                  }
                  
                  return hideField;
                </Source>
              </Script>
            </value>
          </entry>
        </Map>
      </Attributes>
      <ValidationScript>
        <Source>
// empty messages list

import sailpoint.tools.Message;   

List messages = new ArrayList();
          int requiredlength = 50;
          

if(null != value &amp;&amp; value.length() &lt; 50){          	
	Message message = new Message();
	message.setKey("Please ensure that the minimum length is 50 characters, remaining characters "+(requiredlength-value.length())+"/50");
	messages.add(message);
}
return messages;          
          
        </Source>
      </ValidationScript>
    </Field>
  </Section>
  <Section label="Approval Status" name="Approval Status" type="datatable">
    <Field helpKey="Please find Approval Status">
      <Attributes>
        <Map>
          <entry key="contentIsEscaped" value="true" />
        </Map>
      </Attributes>
      <RuleRef>
        <Reference class="sailpoint.object.Rule" name="ps-approvalStatus-FieldValue-DeptHead" />
      </RuleRef>
    </Field>
  </Section>
  <Button action="next" label="Approve" />
  <Button action="back" label="Reject" value="Reject" />
  <Button action="cancel" label="nav_cancel" />
</Form>

</sailpoint>